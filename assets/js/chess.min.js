
/* Minimal chess representation (very simplified, not full rules). For demo and local play only. */
window.MicroChess=(function(){
  const start=[
   "rnbqkbnr",
   "pppppppp",
   "........",
   "........",
   "........",
   "........",
   "PPPPPPPP",
   "RNBQKBNR"];
  let board=start.map(r=>r.split(""));
  let turn='w';
  function get(){ return board.map(r=>r.join("")); }
  function isWhite(p){ return p>='A'&&p<='Z'; }
  function isBlack(p){ return p>='a'&&p<='z'; }
  function move(fr,fc,tr,tc){
    const p=board[fr][fc]; if(!p) return false;
    const white=isWhite(p); if((white && turn!=='w')||(!white && turn!=='b')) return false;
    // Allow any non-capturing single-step move forward for pawns; any move for others (demo only)
    let ok=false;
    if(p==='P'){ ok=(tr===fr-1 && tc===fc && board[tr][tc]==='.') }
    else if(p==='p'){ ok=(tr===fr+1 && tc===fc && board[tr][tc]==='.') }
    else ok=board[tr][tc]==='.' || (white?isBlack(board[tr][tc]):isWhite(board[tr][tc]));
    if(!ok) return false;
    board[tr][tc]=p; board[fr][fc]='.'; turn= (turn==='w'?'b':'w'); return true;
  }
  function reset(){ board=start.map(r=>r.split("")); turn='w'; }
  return {get,move,reset};
})();
